<!doctype html>
<html>
<body>
<div id="wrap">
</div>
</body>
<style>
* {
    box-sizing: border-box;
}
body {
    background: #000;
    font-family: Noto Sans;
    color: #fff;
    font-size: 16px;
    margin: 0;
}
#wrap {
    width: 100vw;
    height: 100vh;
    display: grid;
    place-items: center;
    padding: 10px;
}
.widget {
    width: 100%;
    border-top: 1px solid #999;
    padding-bottom: 10px;
}
.widget .label {
    padding-top: 10px;
}
.widget:first-child {
    border-top: none;
}
.widget:first-child .label {
    padding-top: 0;
}
.widget-size-small .data {
    font-size: 24px;
    line-height: 16px;
}
.widget-size-medium .data {
    font-size: 48px;
    line-height: 48px;
}
.widget-size-large .data {
    font-size: 90px;
    line-height: 72px;
}

.widget-content {
    display: grid;
    grid-template-columns: auto auto;
    align-items: center;
}
.widget-inner:nth-child(odd) {
    justify-self: start;
}
.widget-inner:nth-child(even) {
    justify-self: end;
}

</style>
<script>
    API_URL = "http://localhost:8080"
    buildModule = (inkymodule) => `
        <div class="widget widget-name-${inkymodule.name}">
            <div class="label">
                ${inkymodule.label}
            </div>
            <div class="widget-content">
            ${buildWidgets(inkymodule)}
            </div>
        </div>
        `
        
    buildWidgets = (inkymodule) => {
        if (typeof inkymodule.size == "undefined") {
            return inkymodule.widgets.reduce((widgetColumns, widgetColumn) => `
            ${widgetColumns}
            ${buildInnerWidget(widgetColumn.size, inkymodule.data[widgetColumn.name])}`, "")
        } else {
            return buildInnerWidget(inkymodule.size, inkymodule.data)
        }
    }

    buildInnerWidget = (size, data) => `
        <div class="widget-inner widget-size-${size}">
            <div class="data">
                <span>
                    ${data}
                </span>
            </div>
        </div>`
    wrap = document.getElementById("wrap")
    fetch(`${API_URL}/data`)
    .then(response => response.json())
    .then(data => {
        data.map((inkymodule) => {
            wrap.append(new DOMParser().parseFromString(buildModule(inkymodule), "text/html").body.firstElementChild)
        })
    })
</script>
</html>